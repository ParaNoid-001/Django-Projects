{% extends "base.html" %}
{% block content %}

<div class="container mt-5" style="padding-bottom: 100px;">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-success">Recipes Gallery</h2>
    </div>

    <!-- Search Form -->
    <div class="row mb-4">
        <div class="col-md-6 mx-auto">
            <form method="GET" action="{% url 'vege:recipe_gallery' %}" class="input-group">
                <input type="text" name="search" class="form-control" placeholder="Search recipes by name..." 
                       value="{{ request.GET.search }}" aria-label="Search recipes">
                <button class="btn btn-outline-success" type="submit">
                    <i class="bi bi-search"></i> Search
                </button>
                {% if request.GET.search %}
                <a href="{% url 'vege:recipe_gallery' %}" class="btn btn-outline-danger">
                    <i class="bi bi-x-circle"></i> Clear
                </a>
                {% endif %}
            </form>
        </div>
    </div>

    <div class="row">
        {% for recipe in recipes %}
        <div class="col-md-3 mb-4">
            <a href="{% url 'vege:recipe_detail' recipe.id %}" class="text-decoration-none">
                <div class="gallery-item position-relative">
                    <img src="{{ recipe.Recipe_image.url }}" class="img-fluid rounded shadow-sm gallery-image" 
                         alt="{{ recipe.Recipe_name }}" title="{{ recipe.Recipe_name }}">
                    <div class="gallery-overlay">
                        <h5 class="text-white text-center">{{ recipe.Recipe_name }}</h5>
                        <p class="text-white text-center small">{{ recipe.Recipe_description|truncatechars:60 }}</p>
                    </div>
                </div>
            </a>
        </div>
        {% empty %}
        <div class="col-12">
            <div class="alert alert-info text-center">
                {% if request.GET.search %}
                No recipes found matching "{{ request.GET.search }}". 
                {% else %}
                No recipes found. 
                {% endif %}
                {% if perms.vege.can_add_recipe %}
                <a href="{% url 'vege:add_recipe' %}" class="alert-link">Add some recipes</a> first.
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<style>
    .gallery-item {
        transition: all 0.3s ease;
        overflow: hidden;
        border-radius: 8px;
        height: 250px;
    }
    
    .gallery-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }
    
    .gallery-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        padding: 15px;
        transform: translateY(100%);
        transition: transform 0.3s ease;
        height: 100%;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }
    
    .gallery-item:hover .gallery-overlay {
        transform: translateY(0);
    }
    
    .gallery-item:hover .gallery-image {
        transform: scale(1.1);
    }
</style>

{% endblock %}